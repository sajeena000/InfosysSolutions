import{_ as B}from"./Bch17VXu.js";import{_ as F}from"./B7zsFk_Y.js";import{r as n,C as j,H as A,c as r,a as e,l as L,b as d,n as s,F as N,m as z,k as q,t as p,p as R,q as v,v as h,x as $,T as H,y as O,o as a}from"./BAvuBg4s.js";import{F as T}from"./DOlDDEdy.js";import{P as W}from"./D4D9W4AW.js";import{T as X}from"./CwKXUYwU.js";import{X as G}from"./BwZpcNeh.js";import"./DlAUqK2U.js";import"./CSLnjY7V.js";import"./uoPWt5tl.js";import"./CJ2mP9ci.js";const J={class:"space-y-8"},K={class:"flex flex-col md:flex-row md:items-center justify-between gap-4"},Q={key:0,class:"text-center py-20"},Y={key:1,class:"text-center py-20 border border-dashed border-white/10 rounded-2xl"},Z={key:2,class:"space-y-4"},ee={class:"w-24 h-16 shrink-0 bg-slate-800 rounded-lg overflow-hidden"},te=["src","alt"],se={key:1,class:"w-full h-full flex items-center justify-center"},le={class:"flex-1 min-w-0"},oe={class:"text-white font-medium text-lg truncate"},ie={class:"text-slate-500 text-sm truncate"},ne={class:"flex items-center gap-4"},ae={class:"text-slate-500 text-sm hidden md:block"},re={class:"flex gap-2"},de=["onClick"],ue=["onClick"],ce={key:0,class:"fixed inset-0 z-[100] flex items-center justify-center px-4"},me={class:"relative w-full max-w-2xl bg-slate-900 border border-white/10 rounded-2xl shadow-2xl p-6 overflow-hidden max-h-[90vh] overflow-y-auto"},fe={class:"flex justify-between items-center mb-6"},pe={class:"text-xl font-display font-bold text-white"},xe={class:"space-y-1"},be={class:"space-y-1"},ge={class:"space-y-1"},ve={class:"space-y-1"},he={class:"space-y-1"},we={class:"flex items-center justify-between p-4 bg-slate-950/50 rounded-xl border border-white/5"},ye={class:"pt-4 flex gap-3"},_e=["disabled"],Be={__name:"blogs",setup(ke){const y=n([]),D=n(!0),u=n(!1),c=n(!1),w=n(!1),x=n(!1),b=n(null),_=n(null),m=n(""),f=n(""),g=n("success"),o=n({id:null,title:"",slug:"",coverImage:"",excerpt:"",content:"",published:!1});j(()=>{k()});const k=async()=>{try{y.value=await $fetch("/api/blogs")}catch(i){console.error("Failed to fetch posts:",i)}finally{D.value=!1}},C=(i=null)=>{i?(c.value=!0,o.value={id:i.id,title:i.title,slug:i.slug,coverImage:i.coverImage||"",excerpt:i.excerpt||"",content:i.content||"",published:!!i.publishedAt}):(c.value=!1,o.value={id:null,title:"",slug:"",coverImage:"",excerpt:"",content:"",published:!1}),u.value=!0},P=async()=>{w.value=!0;try{c.value?(await $fetch(`/api/blogs/${o.value.id}`,{method:"PUT",body:o.value}),m.value="Updated",f.value="Blog post updated successfully."):(await $fetch("/api/blogs",{method:"POST",body:o.value}),m.value="Created",f.value="Blog post created successfully."),g.value="success",u.value=!1,k()}catch(i){m.value="Error",f.value="Failed to save post.",g.value="error",console.error(i)}finally{w.value=!1,_.value.show()}},U=i=>{b.value=i,x.value=!0},M=async()=>{if(b.value)try{await $fetch(`/api/blogs/${b.value.id}`,{method:"DELETE"}),m.value="Deleted",f.value="Blog post deleted.",g.value="success",k()}catch{m.value="Error",f.value="Failed to delete post.",g.value="error"}finally{x.value=!1,b.value=null,_.value.show()}},V=i=>i?new Date(i).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"Unknown";return A(()=>o.value.title,i=>{c.value||(o.value.slug=i.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim())}),(i,t)=>{const E=B,I=F;return a(),r("div",J,[e("div",K,[t[12]||(t[12]=e("div",null,[e("h1",{class:"text-3xl font-display font-bold text-white mb-2"},"Blog Posts"),e("p",{class:"text-slate-400"},"Manage blog content for the public website.")],-1)),e("button",{onClick:t[0]||(t[0]=l=>C()),class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg text-sm font-medium shadow-lg shadow-indigo-500/20 transition-all"}," + New Post ")]),s(D)?(a(),r("div",Q,[...t[13]||(t[13]=[e("div",{class:"w-8 h-8 border-4 border-indigo-600 border-t-transparent rounded-full animate-spin mx-auto"},null,-1),e("p",{class:"text-slate-500 mt-4"},"Loading posts...",-1)])])):s(y).length===0?(a(),r("div",Y,[d(s(T),{class:"w-12 h-12 text-slate-500 mx-auto mb-4"}),t[14]||(t[14]=e("p",{class:"text-slate-400 mb-2"},"No blog posts yet",-1)),e("button",{onClick:t[1]||(t[1]=l=>C()),class:"text-indigo-400 hover:text-indigo-300 text-sm font-medium"}," Create your first post ")])):(a(),r("div",Z,[(a(!0),r(N,null,z(s(y),l=>(a(),r("div",{key:l.id,class:"p-6 rounded-2xl bg-slate-900/40 border border-white/5 hover:border-indigo-500/30 transition-all flex flex-col md:flex-row md:items-center gap-4"},[e("div",ee,[l.coverImage?(a(),r("img",{key:0,src:l.coverImage,alt:l.title,class:"w-full h-full object-cover"},null,8,te)):(a(),r("div",se,[d(s(T),{class:"w-6 h-6 text-slate-600"})]))]),e("div",le,[e("h3",oe,p(l.title),1),e("p",ie,p(l.slug),1)]),e("div",ne,[e("span",{class:$(["px-3 py-1 text-xs font-medium rounded-full",l.publishedAt?"bg-emerald-500/20 text-emerald-400":"bg-amber-500/20 text-amber-400"])},p(l.publishedAt?"Published":"Draft"),3),e("span",ae,p(V(l.createdAt)),1),e("div",re,[e("button",{onClick:S=>C(l),class:"p-2 text-slate-400 hover:text-white hover:bg-white/10 rounded-lg transition-colors",title:"Edit"},[d(s(W),{class:"w-4 h-4"})],8,de),e("button",{onClick:S=>U(l),class:"p-2 text-slate-400 hover:text-rose-500 hover:bg-rose-500/10 rounded-lg transition-colors",title:"Delete"},[d(s(X),{class:"w-4 h-4"})],8,ue)])])]))),128))])),(a(),L(H,{to:"body"},[s(u)?(a(),r("div",ce,[e("div",{class:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:t[2]||(t[2]=l=>u.value=!1)}),e("div",me,[e("div",fe,[e("h3",pe,p(s(c)?"Edit Post":"Create Post"),1),e("button",{onClick:t[3]||(t[3]=l=>u.value=!1),class:"text-slate-400 hover:text-white"},[d(s(G),{class:"w-5 h-5"})])]),e("form",{class:"space-y-4",onSubmit:R(P,["prevent"])},[e("div",xe,[t[15]||(t[15]=e("label",{class:"text-sm font-medium text-slate-300"},"Title",-1)),v(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>s(o).title=l),required:"",type:"text",class:"w-full bg-slate-950 border border-white/10 rounded-xl px-4 py-2.5 text-white text-sm focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/50 transition-all"},null,512),[[h,s(o).title]])]),e("div",be,[t[16]||(t[16]=e("label",{class:"text-sm font-medium text-slate-300"},"Slug",-1)),v(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>s(o).slug=l),required:"",type:"text",placeholder:"url-friendly-slug",class:"w-full bg-slate-950 border border-white/10 rounded-xl px-4 py-2.5 text-white text-sm focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/50 transition-all"},null,512),[[h,s(o).slug]])]),e("div",ge,[t[17]||(t[17]=e("label",{class:"text-sm font-medium text-slate-300"},"Cover Image URL",-1)),v(e("input",{"onUpdate:modelValue":t[6]||(t[6]=l=>s(o).coverImage=l),type:"url",placeholder:"https://...",class:"w-full bg-slate-950 border border-white/10 rounded-xl px-4 py-2.5 text-white text-sm focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/50 transition-all"},null,512),[[h,s(o).coverImage]])]),e("div",ve,[t[18]||(t[18]=e("label",{class:"text-sm font-medium text-slate-300"},"Excerpt",-1)),v(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=l=>s(o).excerpt=l),rows:"2",placeholder:"A brief summary of the post...",class:"w-full bg-slate-950 border border-white/10 rounded-xl px-4 py-2.5 text-white text-sm focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/50 transition-all resize-none"},null,512),[[h,s(o).excerpt]])]),e("div",he,[t[19]||(t[19]=e("label",{class:"text-sm font-medium text-slate-300"},"Content (Markdown)",-1)),v(e("textarea",{"onUpdate:modelValue":t[8]||(t[8]=l=>s(o).content=l),required:"",rows:"10",placeholder:"Write your post content in Markdown...",class:"w-full bg-slate-950 border border-white/10 rounded-xl px-4 py-2.5 text-white text-sm font-mono focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/50 transition-all resize-none"},null,512),[[h,s(o).content]]),t[20]||(t[20]=e("p",{class:"text-xs text-slate-500"},"Supports Markdown: **bold**, *italic*, # headers, etc.",-1))]),e("div",we,[t[21]||(t[21]=e("div",null,[e("p",{class:"text-sm font-medium text-white"},"Publish Now"),e("p",{class:"text-xs text-slate-500"},"Make this post visible on the public website")],-1)),e("button",{type:"button",onClick:t[9]||(t[9]=l=>s(o).published=!s(o).published),class:$(["w-12 h-7 rounded-full relative transition-colors",s(o).published?"bg-indigo-600":"bg-slate-700"])},[e("div",{class:$(["absolute top-1 w-5 h-5 bg-white rounded-full transition-all duration-300",s(o).published?"right-1":"left-1"])},null,2)],2)]),e("div",ye,[e("button",{type:"button",onClick:t[10]||(t[10]=l=>u.value=!1),class:"flex-1 px-4 py-2.5 rounded-xl bg-white/5 hover:bg-white/10 text-white text-sm font-medium border border-white/5 transition-colors"}," Cancel "),e("button",{type:"submit",disabled:s(w),class:"flex-1 px-4 py-2.5 rounded-xl bg-indigo-600 hover:bg-indigo-500 text-white text-sm font-medium shadow-lg shadow-indigo-500/20 transition-all disabled:opacity-70"},p(s(w)?"Saving...":s(c)?"Save Changes":"Create Post"),9,_e)])],32)])])):q("",!0)])),d(E,{modelValue:s(x),"onUpdate:modelValue":t[11]||(t[11]=l=>O(x)?x.value=l:null),title:"Delete Post",description:`Are you sure you want to delete '${s(b)?.title}'? This action cannot be undone.`,"confirm-text":"Delete",onConfirm:M},null,8,["modelValue","description"]),d(I,{ref_key:"toastRef",ref:_,title:s(m),message:s(f),type:s(g)},null,8,["title","message","type"])])}}};export{Be as default};
