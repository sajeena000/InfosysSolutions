import{_ as X}from"./Da2N3gVy.js";import{_ as G}from"./CWJkBCFc.js";import{_ as H}from"./D8Mk3aHN.js";import{g as J,r as i,k as K,x as S,c as r,a as e,y as I,b as d,F as B,z,q as s,m as A,s as F,t as u,n as Y,p as w,v as y,B as C,T as Z,o as a}from"./B4XNpz0r.js";import{F as j}from"./ZLnja1Tz.js";import{P as ee}from"./C9qu1dzL.js";import{T as te}from"./I1LrKdXv.js";import{X as se}from"./DoLOoRmo.js";import"./DQqXm2Cx.js";import"./1iMD3goh.js";import"./DlAUqK2U.js";import"./CdaJuJFX.js";import"./C5sq60xm.js";const le={class:"space-y-8"},oe={class:"flex flex-col md:flex-row md:items-center justify-between gap-4"},ne={class:"flex items-center gap-4"},ie={class:"flex p-1 bg-slate-900/50 border border-white/5 rounded-lg backdrop-blur-sm"},ae=["onClick"],re={key:0,class:"text-center py-20"},de={key:1,class:"text-center py-20 border border-dashed border-white/10 rounded-2xl"},ue={key:2,class:"space-y-4"},ce={class:"w-24 h-16 shrink-0 bg-slate-800 rounded-lg overflow-hidden"},me=["src","alt"],pe={key:1,class:"w-full h-full flex items-center justify-center"},fe={class:"flex-1 min-w-0"},xe={class:"text-white font-medium text-lg truncate"},be={class:"text-slate-500 text-sm truncate"},ge={class:"flex items-center gap-4"},ve={class:"text-slate-500 text-sm hidden md:block"},he={class:"flex gap-2"},we=["onClick"],ye=["onClick"],_e={key:0,class:"fixed inset-0 z-[100] flex items-center justify-center px-4"},ke={class:"relative w-full max-w-2xl bg-slate-900 border border-white/10 rounded-2xl shadow-2xl p-6 overflow-hidden max-h-[90vh] overflow-y-auto"},Ce={class:"flex justify-between items-center mb-6"},Pe={class:"text-xl font-display font-bold text-white"},$e={class:"space-y-1"},De={class:"space-y-1"},Te={class:"space-y-1"},Ue={class:"space-y-1"},Me={class:"space-y-1"},Se={class:"flex items-center justify-between p-4 bg-slate-950/50 rounded-xl border border-white/5"},Ve={class:"pt-4 flex gap-3"},Ee=["disabled"],Ge={__name:"blogs",setup(Ie){const P=J(),$=i([]),D=i(!0),c=i(!1),m=i(!1),_=i(!1),b=i(!1),g=i(null),T=i(null),p=i(""),f=i(""),v=i("success"),x=i(1),U=i(0),V=i(10),h=i("all"),n=i({id:null,title:"",slug:"",coverImage:"",excerpt:"",content:"",published:!1});K(()=>{k()});const k=async()=>{D.value=!0;try{const o=await $fetch("/api/admin/blogs",{params:{page:x.value,limit:V.value,status:h.value,search:P.searchQuery}});$.value=o.data,U.value=o.meta.total}catch(o){console.error("Failed to fetch posts:",o)}finally{D.value=!1}};S([x,h,()=>P.searchQuery],()=>{k()}),S([h,()=>P.searchQuery],()=>{x.value=1});const M=(o=null)=>{o?(m.value=!0,n.value={id:o.id,title:o.title,slug:o.slug,coverImage:o.coverImage||"",excerpt:o.excerpt||"",content:o.content||"",published:!!o.publishedAt}):(m.value=!1,n.value={id:null,title:"",slug:"",coverImage:"",excerpt:"",content:"",published:!1}),c.value=!0},L=async()=>{_.value=!0;try{m.value?(await $fetch(`/api/admin/blogs/${n.value.id}`,{method:"PUT",body:n.value}),p.value="Updated",f.value="Blog post updated successfully."):(await $fetch("/api/admin/blogs",{method:"POST",body:n.value}),p.value="Created",f.value="Blog post created successfully."),v.value="success",c.value=!1,k()}catch(o){p.value="Error",f.value="Failed to save post.",v.value="error",console.error(o)}finally{_.value=!1,T.value.show()}},N=o=>{g.value=o,b.value=!0},q=async()=>{if(g.value)try{await $fetch(`/api/admin/blogs/${g.value.id}`,{method:"DELETE"}),p.value="Deleted",f.value="Blog post deleted.",v.value="success",k()}catch{p.value="Error",f.value="Failed to delete post.",v.value="error"}finally{b.value=!1,g.value=null,T.value.show()}},R=o=>o?new Date(o).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"Unknown";return S(()=>n.value.title,o=>{m.value||(n.value.slug=o.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim())}),(o,t)=>{const Q=X,O=G,W=H;return a(),r("div",le,[e("div",oe,[t[13]||(t[13]=e("div",null,[e("h1",{class:"text-3xl font-display font-bold text-white mb-2"},"Blog Posts"),e("p",{class:"text-slate-400"},"Manage blog content for the public website.")],-1)),e("div",ne,[e("div",ie,[(a(),r(B,null,z(["all","published","draft"],l=>e("button",{key:l,onClick:E=>h.value=l,class:C(["px-3 py-1.5 text-xs font-medium rounded-md capitalize transition-all",s(h)===l?"bg-indigo-600 text-white shadow-lg":"text-slate-400 hover:text-white"])},u(l),11,ae)),64))]),e("button",{onClick:t[0]||(t[0]=l=>M()),class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg text-sm font-medium shadow-lg shadow-indigo-500/20 transition-all"}," + New Post ")])]),s(D)?(a(),r("div",re,[...t[14]||(t[14]=[e("div",{class:"w-8 h-8 border-4 border-indigo-600 border-t-transparent rounded-full animate-spin mx-auto"},null,-1),e("p",{class:"text-slate-500 mt-4"},"Loading posts...",-1)])])):s($).length===0?(a(),r("div",de,[d(s(j),{class:"w-12 h-12 text-slate-500 mx-auto mb-4"}),t[15]||(t[15]=e("p",{class:"text-slate-400 mb-2"},"No blog posts yet",-1)),e("button",{onClick:t[1]||(t[1]=l=>M()),class:"text-indigo-400 hover:text-indigo-300 text-sm font-medium"}," Create your first post ")])):(a(),r("div",ue,[(a(!0),r(B,null,z(s($),l=>(a(),r("div",{key:l.id,class:"p-6 rounded-2xl bg-slate-900/40 border border-white/5 hover:border-indigo-500/30 transition-all flex flex-col md:flex-row md:items-center gap-4"},[e("div",ce,[l.coverImage?(a(),r("img",{key:0,src:l.coverImage,alt:l.title,class:"w-full h-full object-cover"},null,8,me)):(a(),r("div",pe,[d(s(j),{class:"w-6 h-6 text-slate-600"})]))]),e("div",fe,[e("h3",xe,u(l.title),1),e("p",be,u(l.slug),1)]),e("div",ge,[e("span",{class:C(["px-3 py-1 text-xs font-medium rounded-full",l.publishedAt?"bg-emerald-500/20 text-emerald-400":"bg-amber-500/20 text-amber-400"])},u(l.publishedAt?"Published":"Draft"),3),e("span",ve,u(R(l.createdAt)),1),e("div",he,[e("button",{onClick:E=>M(l),class:"p-2 text-slate-400 hover:text-white hover:bg-white/10 rounded-lg transition-colors",title:"Edit"},[d(s(ee),{class:"w-4 h-4"})],8,we),e("button",{onClick:E=>N(l),class:"p-2 text-slate-400 hover:text-rose-500 hover:bg-rose-500/10 rounded-lg transition-colors",title:"Delete"},[d(s(te),{class:"w-4 h-4"})],8,ye)])])]))),128)),s(U)>0?(a(),I(Q,{key:0,"current-page":s(x),"onUpdate:currentPage":t[2]||(t[2]=l=>F(x)?x.value=l:null),total:s(U),"items-per-page":s(V)},null,8,["current-page","total","items-per-page"])):A("",!0)])),(a(),I(Z,{to:"body"},[s(c)?(a(),r("div",_e,[e("div",{class:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:t[3]||(t[3]=l=>c.value=!1)}),e("div",ke,[e("div",Ce,[e("h3",Pe,u(s(m)?"Edit Post":"Create Post"),1),e("button",{onClick:t[4]||(t[4]=l=>c.value=!1),class:"text-slate-400 hover:text-white"},[d(s(se),{class:"w-5 h-5"})])]),e("form",{class:"space-y-4",onSubmit:Y(L,["prevent"])},[e("div",$e,[t[16]||(t[16]=e("label",{class:"text-sm font-medium text-slate-300"},"Title",-1)),w(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>s(n).title=l),required:"",type:"text",class:"w-full bg-slate-950 border border-white/10 rounded-xl px-4 py-2.5 text-white text-sm focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/50 transition-all"},null,512),[[y,s(n).title]])]),e("div",De,[t[17]||(t[17]=e("label",{class:"text-sm font-medium text-slate-300"},"Slug",-1)),w(e("input",{"onUpdate:modelValue":t[6]||(t[6]=l=>s(n).slug=l),required:"",type:"text",placeholder:"url-friendly-slug",class:"w-full bg-slate-950 border border-white/10 rounded-xl px-4 py-2.5 text-white text-sm focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/50 transition-all"},null,512),[[y,s(n).slug]])]),e("div",Te,[t[18]||(t[18]=e("label",{class:"text-sm font-medium text-slate-300"},"Cover Image URL",-1)),w(e("input",{"onUpdate:modelValue":t[7]||(t[7]=l=>s(n).coverImage=l),type:"url",placeholder:"https://...",class:"w-full bg-slate-950 border border-white/10 rounded-xl px-4 py-2.5 text-white text-sm focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/50 transition-all"},null,512),[[y,s(n).coverImage]])]),e("div",Ue,[t[19]||(t[19]=e("label",{class:"text-sm font-medium text-slate-300"},"Excerpt",-1)),w(e("textarea",{"onUpdate:modelValue":t[8]||(t[8]=l=>s(n).excerpt=l),rows:"2",placeholder:"A brief summary of the post...",class:"w-full bg-slate-950 border border-white/10 rounded-xl px-4 py-2.5 text-white text-sm focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/50 transition-all resize-none"},null,512),[[y,s(n).excerpt]])]),e("div",Me,[t[20]||(t[20]=e("label",{class:"text-sm font-medium text-slate-300"},"Content (Markdown)",-1)),w(e("textarea",{"onUpdate:modelValue":t[9]||(t[9]=l=>s(n).content=l),required:"",rows:"10",placeholder:"Write your post content in Markdown...",class:"w-full bg-slate-950 border border-white/10 rounded-xl px-4 py-2.5 text-white text-sm font-mono focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/50 transition-all resize-none"},null,512),[[y,s(n).content]]),t[21]||(t[21]=e("p",{class:"text-xs text-slate-500"},"Supports Markdown: **bold**, *italic*, # headers, etc.",-1))]),e("div",Se,[t[22]||(t[22]=e("div",null,[e("p",{class:"text-sm font-medium text-white"},"Publish Now"),e("p",{class:"text-xs text-slate-500"},"Make this post visible on the public website")],-1)),e("button",{type:"button",onClick:t[10]||(t[10]=l=>s(n).published=!s(n).published),class:C(["w-12 h-7 rounded-full relative transition-colors",s(n).published?"bg-indigo-600":"bg-slate-700"])},[e("div",{class:C(["absolute top-1 w-5 h-5 bg-white rounded-full transition-all duration-300",s(n).published?"right-1":"left-1"])},null,2)],2)]),e("div",Ve,[e("button",{type:"button",onClick:t[11]||(t[11]=l=>c.value=!1),class:"flex-1 px-4 py-2.5 rounded-xl bg-white/5 hover:bg-white/10 text-white text-sm font-medium border border-white/5 transition-colors"}," Cancel "),e("button",{type:"submit",disabled:s(_),class:"flex-1 px-4 py-2.5 rounded-xl bg-indigo-600 hover:bg-indigo-500 text-white text-sm font-medium shadow-lg shadow-indigo-500/20 transition-all disabled:opacity-70"},u(s(_)?"Saving...":s(m)?"Save Changes":"Create Post"),9,Ee)])],32)])])):A("",!0)])),d(O,{modelValue:s(b),"onUpdate:modelValue":t[12]||(t[12]=l=>F(b)?b.value=l:null),title:"Delete Post",description:`Are you sure you want to delete '${s(g)?.title}'? This action cannot be undone.`,"confirm-text":"Delete",onConfirm:q},null,8,["modelValue","description"]),d(W,{ref_key:"toastRef",ref:T,title:s(p),message:s(f),type:s(v)},null,8,["title","message","type"])])}}};export{Ge as default};
