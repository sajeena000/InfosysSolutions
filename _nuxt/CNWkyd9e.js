import{_ as A}from"./BlqDiOG6.js";import{_ as L}from"./DzlxV7ns.js";import{_ as j}from"./9SQ5mlpr.js";import{g as Q,r as l,k as H,x as q,c as n,a as t,y as G,m as D,b as u,F as V,z as I,q as s,t as i,s as U,o as r,B as E,d as $}from"./PsU8fGEG.js";import{u as J}from"./D_M7QkOh.js";import{M as F}from"./CDjUCZmC.js";import{P as K}from"./ZIq6rzTE.js";import{c as O}from"./w7z5CoPY.js";import{T as W}from"./-izbdZX4.js";import"./ZVIKdQKX.js";import"./DlAUqK2U.js";import"./DUIq94hi.js";import"./C0WVU3vH.js";const X=O("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]),Y={class:"space-y-8"},Z={class:"flex flex-col md:flex-row md:items-center justify-between gap-4"},ee={class:"flex gap-2"},te=["onClick"],se={key:0,class:"text-center py-20"},ae={key:1,class:"text-center py-20 border border-dashed border-white/10 rounded-2xl"},oe={class:"text-slate-400"},le={key:2,class:"space-y-4"},re={class:"flex flex-col lg:flex-row lg:items-start gap-4"},ne={class:"flex-1 min-w-0"},ie={class:"flex items-center gap-3 mb-2"},ce={class:"text-white font-medium text-lg"},de={class:"flex flex-wrap gap-4 text-sm text-slate-500 mb-4"},ue=["href"],me={key:0,class:"flex items-center gap-1"},pe={key:1,class:"flex items-center gap-1"},fe={class:"text-slate-300 text-sm whitespace-pre-wrap"},he={class:"text-slate-500 text-xs mt-4"},ve={class:"flex lg:flex-col items-center gap-2"},ge=["value","onChange"],xe=["onClick"],Ee={__name:"contacts",setup(_e){const _=Q(),{formatDate:M}=J(),x=l([]),y=l(!0),c=l("all"),p=l(!1),f=l(null),b=l(null),h=l(""),v=l(""),g=l("success");H(()=>{k()});const m=l(1),w=l(0),P=l(10),k=async()=>{y.value=!0;try{const o=await $fetch("/api/admin/contacts",{params:{page:m.value,limit:P.value,status:c.value,search:_.searchQuery}});x.value=o.data,w.value=o.meta.total}catch(o){console.error("Failed to fetch contacts:",o)}finally{y.value=!1}};q([m,c,()=>_.searchQuery],()=>{k()}),q([c,()=>_.searchQuery],()=>{m.value=1});const N=(o,a)=>{const d=o.target.value;S(a,d)},S=async(o,a)=>{try{await $fetch(`/api/admin/contacts/${o}`,{method:"PUT",body:{status:a}});const d=x.value.find(C=>C.id===o);d&&(d.status=a),h.value="Updated",v.value="Status updated successfully.",g.value="success"}catch{h.value="Error",v.value="Failed to update status.",g.value="error"}b.value.show()},B=o=>{f.value=o,p.value=!0},R=async()=>{if(f.value)try{await $fetch(`/api/admin/contacts/${f.value.id}`,{method:"DELETE"}),h.value="Deleted",v.value="Inquiry deleted.",g.value="success",k()}catch{h.value="Error",v.value="Failed to delete inquiry.",g.value="error"}finally{p.value=!1,f.value=null,b.value.show()}};return(o,a)=>{const d=A,C=L,z=j;return r(),n("div",Y,[t("div",Z,[a[2]||(a[2]=t("div",null,[t("h1",{class:"text-3xl font-display font-bold text-white mb-2"},"Contact Inquiries"),t("p",{class:"text-slate-400"},"View and manage messages from the public contact form.")],-1)),t("div",ee,[(r(),n(V,null,I(["all","new","in-progress","resolved"],e=>t("button",{key:e,onClick:T=>c.value=e,class:E(["px-3 py-1.5 rounded-lg text-xs font-medium capitalize transition-all",s(c)===e?"bg-indigo-600 text-white":"bg-white/5 text-slate-400 hover:text-white"])},i(e==="in-progress"?"In Progress":e),11,te)),64))])]),s(y)?(r(),n("div",se,[...a[3]||(a[3]=[t("div",{class:"w-8 h-8 border-4 border-indigo-600 border-t-transparent rounded-full animate-spin mx-auto"},null,-1),t("p",{class:"text-slate-500 mt-4"},"Loading inquiries...",-1)])])):s(x).length===0?(r(),n("div",ae,[u(s(F),{class:"w-12 h-12 text-slate-500 mx-auto mb-4"}),t("p",oe,"No "+i(s(c)==="all"?"":s(c))+" inquiries found",1)])):(r(),n("div",le,[(r(!0),n(V,null,I(s(x),e=>(r(),n("div",{key:e.id,class:"p-6 rounded-2xl bg-slate-900/40 border border-white/5 hover:border-indigo-500/30 transition-all"},[t("div",re,[t("div",ne,[t("div",ie,[t("h3",ce,i(e.name),1),t("span",{class:E(["px-2 py-0.5 text-[10px] font-medium uppercase tracking-wider rounded-full",{"bg-rose-500/20 text-rose-400":e.status==="new","bg-amber-500/20 text-amber-400":e.status==="in-progress","bg-emerald-500/20 text-emerald-400":e.status==="resolved"}])},i(e.status),3)]),t("div",de,[t("a",{href:`mailto:${e.email}`,class:"flex items-center gap-1 hover:text-indigo-400"},[u(s(F),{class:"w-4 h-4"}),$(" "+i(e.email),1)],8,ue),e.phone?(r(),n("span",me,[u(s(K),{class:"w-4 h-4"}),$(" "+i(e.phone),1)])):D("",!0),e.subject?(r(),n("span",pe,[u(s(X),{class:"w-4 h-4"}),$(" "+i(e.subject),1)])):D("",!0)]),t("p",fe,i(e.message),1),t("p",he," Received "+i(s(M)(e.createdAt,"withTime")),1)]),t("div",ve,[t("select",{value:e.status,onChange:T=>N(T,e.id),class:"bg-slate-950 border border-white/10 rounded-lg text-sm text-slate-300 px-3 py-2 outline-none focus:border-indigo-500 transition-colors"},[...a[4]||(a[4]=[t("option",{value:"new"},"New",-1),t("option",{value:"in-progress"},"In Progress",-1),t("option",{value:"resolved"},"Resolved",-1)])],40,ge),t("button",{onClick:T=>B(e),class:"p-2 text-slate-400 hover:text-rose-500 hover:bg-rose-500/10 rounded-lg transition-colors",title:"Delete"},[u(s(W),{class:"w-4 h-4"})],8,xe)])])]))),128))])),s(w)>0?(r(),G(d,{key:3,"current-page":s(m),"onUpdate:currentPage":a[0]||(a[0]=e=>U(m)?m.value=e:null),total:s(w),"items-per-page":s(P)},null,8,["current-page","total","items-per-page"])):D("",!0),u(C,{modelValue:s(p),"onUpdate:modelValue":a[1]||(a[1]=e=>U(p)?p.value=e:null),title:"Delete Inquiry",description:`Are you sure you want to delete the inquiry from ${s(f)?.name}? This action cannot be undone.`,"confirm-text":"Delete",onConfirm:R},null,8,["modelValue","description"]),u(z,{ref_key:"toastRef",ref:b,title:s(h),message:s(v),type:s(g)},null,8,["title","message","type"])])}}};export{Ee as default};
