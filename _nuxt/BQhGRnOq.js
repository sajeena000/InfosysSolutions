import{_ as X}from"./BlqDiOG6.js";import{_ as G}from"./DzlxV7ns.js";import{_ as H}from"./9SQ5mlpr.js";import{g as J,r as a,k as K,x as V,c as r,a as e,y as S,b as d,F as B,z as F,q as s,m as z,s as A,t as u,n as Y,p as w,v as y,B as C,T as Z,o as n}from"./PsU8fGEG.js";import{u as ee}from"./D_M7QkOh.js";import{F as j}from"./CHNKvUcL.js";import{P as te}from"./DAW6YDx9.js";import{T as se}from"./-izbdZX4.js";import{X as le}from"./BAiJTkiT.js";import"./ZVIKdQKX.js";import"./w7z5CoPY.js";import"./DlAUqK2U.js";import"./DUIq94hi.js";import"./C0WVU3vH.js";const oe={class:"space-y-8"},ie={class:"flex flex-col md:flex-row md:items-center justify-between gap-4"},ae={class:"flex items-center gap-4"},ne={class:"flex p-1 bg-slate-900/50 border border-white/5 rounded-lg backdrop-blur-sm"},re=["onClick"],de={key:0,class:"text-center py-20"},ue={key:1,class:"text-center py-20 border border-dashed border-white/10 rounded-2xl"},ce={key:2,class:"space-y-4"},me={class:"w-24 h-16 shrink-0 bg-slate-800 rounded-lg overflow-hidden"},pe=["src","alt"],fe={key:1,class:"w-full h-full flex items-center justify-center"},xe={class:"flex-1 min-w-0"},be={class:"text-white font-medium text-lg truncate"},ge={class:"text-slate-500 text-sm truncate"},ve={class:"flex items-center gap-4"},he={class:"text-slate-500 text-sm hidden md:block"},we={class:"flex gap-2"},ye=["onClick"],_e=["onClick"],ke={key:0,class:"fixed inset-0 z-[100] flex items-center justify-center px-4"},Ce={class:"relative w-full max-w-2xl bg-slate-900 border border-white/10 rounded-2xl shadow-2xl p-6 overflow-hidden max-h-[90vh] overflow-y-auto"},Pe={class:"flex justify-between items-center mb-6"},$e={class:"text-xl font-display font-bold text-white"},Te={class:"space-y-1"},De={class:"space-y-1"},Ue={class:"space-y-1"},Me={class:"space-y-1"},Ve={class:"space-y-1"},Ee={class:"flex items-center justify-between p-4 bg-slate-950/50 rounded-xl border border-white/5"},Ie={class:"pt-4 flex gap-3"},Se=["disabled"],Je={__name:"blogs",setup(Be){const P=J(),{formatDate:N}=ee(),$=a([]),T=a(!0),c=a(!1),m=a(!1),_=a(!1),b=a(!1),g=a(null),D=a(null),p=a(""),f=a(""),v=a("success"),x=a(1),U=a(0),E=a(10),h=a("all"),o=a({id:null,title:"",slug:"",coverImage:"",excerpt:"",content:"",published:!1});K(()=>{k()});const k=async()=>{T.value=!0;try{const i=await $fetch("/api/admin/blogs",{params:{page:x.value,limit:E.value,status:h.value,search:P.searchQuery}});$.value=i.data,U.value=i.meta.total}catch(i){console.error("Failed to fetch posts:",i)}finally{T.value=!1}};V([x,h,()=>P.searchQuery],()=>{k()}),V([h,()=>P.searchQuery],()=>{x.value=1});const M=(i=null)=>{i?(m.value=!0,o.value={id:i.id,title:i.title,slug:i.slug,coverImage:i.coverImage||"",excerpt:i.excerpt||"",content:i.content||"",published:!!i.publishedAt}):(m.value=!1,o.value={id:null,title:"",slug:"",coverImage:"",excerpt:"",content:"",published:!1}),c.value=!0},L=async()=>{_.value=!0;try{m.value?(await $fetch(`/api/admin/blogs/${o.value.id}`,{method:"PUT",body:o.value}),p.value="Updated",f.value="Blog post updated successfully."):(await $fetch("/api/admin/blogs",{method:"POST",body:o.value}),p.value="Created",f.value="Blog post created successfully."),v.value="success",c.value=!1,k()}catch(i){p.value="Error",f.value="Failed to save post.",v.value="error",console.error(i)}finally{_.value=!1,D.value.show()}},q=i=>{g.value=i,b.value=!0},R=async()=>{if(g.value)try{await $fetch(`/api/admin/blogs/${g.value.id}`,{method:"DELETE"}),p.value="Deleted",f.value="Blog post deleted.",v.value="success",k()}catch{p.value="Error",f.value="Failed to delete post.",v.value="error"}finally{b.value=!1,g.value=null,D.value.show()}};return V(()=>o.value.title,i=>{m.value||(o.value.slug=i.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim())}),(i,t)=>{const Q=X,O=G,W=H;return n(),r("div",oe,[e("div",ie,[t[13]||(t[13]=e("div",null,[e("h1",{class:"text-3xl font-display font-bold text-white mb-2"},"Blog Posts"),e("p",{class:"text-slate-400"},"Manage blog content for the public website.")],-1)),e("div",ae,[e("div",ne,[(n(),r(B,null,F(["all","published","draft"],l=>e("button",{key:l,onClick:I=>h.value=l,class:C(["px-3 py-1.5 text-xs font-medium rounded-md capitalize transition-all",s(h)===l?"bg-indigo-600 text-white shadow-lg":"text-slate-400 hover:text-white"])},u(l),11,re)),64))]),e("button",{onClick:t[0]||(t[0]=l=>M()),class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg text-sm font-medium shadow-lg shadow-indigo-500/20 transition-all"}," + New Post ")])]),s(T)?(n(),r("div",de,[...t[14]||(t[14]=[e("div",{class:"w-8 h-8 border-4 border-indigo-600 border-t-transparent rounded-full animate-spin mx-auto"},null,-1),e("p",{class:"text-slate-500 mt-4"},"Loading posts...",-1)])])):s($).length===0?(n(),r("div",ue,[d(s(j),{class:"w-12 h-12 text-slate-500 mx-auto mb-4"}),t[15]||(t[15]=e("p",{class:"text-slate-400 mb-2"},"No blog posts yet",-1)),e("button",{onClick:t[1]||(t[1]=l=>M()),class:"text-indigo-400 hover:text-indigo-300 text-sm font-medium"}," Create your first post ")])):(n(),r("div",ce,[(n(!0),r(B,null,F(s($),l=>(n(),r("div",{key:l.id,class:"p-6 rounded-2xl bg-slate-900/40 border border-white/5 hover:border-indigo-500/30 transition-all flex flex-col md:flex-row md:items-center gap-4"},[e("div",me,[l.coverImage?(n(),r("img",{key:0,src:l.coverImage,alt:l.title,class:"w-full h-full object-cover"},null,8,pe)):(n(),r("div",fe,[d(s(j),{class:"w-6 h-6 text-slate-600"})]))]),e("div",xe,[e("h3",be,u(l.title),1),e("p",ge,u(l.slug),1)]),e("div",ve,[e("span",{class:C(["px-3 py-1 text-xs font-medium rounded-full",l.publishedAt?"bg-emerald-500/20 text-emerald-400":"bg-amber-500/20 text-amber-400"])},u(l.publishedAt?"Published":"Draft"),3),e("span",he,u(s(N)(l.createdAt)),1),e("div",we,[e("button",{onClick:I=>M(l),class:"p-2 text-slate-400 hover:text-white hover:bg-white/10 rounded-lg transition-colors",title:"Edit"},[d(s(te),{class:"w-4 h-4"})],8,ye),e("button",{onClick:I=>q(l),class:"p-2 text-slate-400 hover:text-rose-500 hover:bg-rose-500/10 rounded-lg transition-colors",title:"Delete"},[d(s(se),{class:"w-4 h-4"})],8,_e)])])]))),128)),s(U)>0?(n(),S(Q,{key:0,"current-page":s(x),"onUpdate:currentPage":t[2]||(t[2]=l=>A(x)?x.value=l:null),total:s(U),"items-per-page":s(E)},null,8,["current-page","total","items-per-page"])):z("",!0)])),(n(),S(Z,{to:"body"},[s(c)?(n(),r("div",ke,[e("div",{class:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:t[3]||(t[3]=l=>c.value=!1)}),e("div",Ce,[e("div",Pe,[e("h3",$e,u(s(m)?"Edit Post":"Create Post"),1),e("button",{onClick:t[4]||(t[4]=l=>c.value=!1),class:"text-slate-400 hover:text-white"},[d(s(le),{class:"w-5 h-5"})])]),e("form",{class:"space-y-4",onSubmit:Y(L,["prevent"])},[e("div",Te,[t[16]||(t[16]=e("label",{class:"text-sm font-medium text-slate-300"},"Title",-1)),w(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>s(o).title=l),required:"",type:"text",class:"w-full bg-slate-950 border border-white/10 rounded-xl px-4 py-2.5 text-white text-sm focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/50 transition-all"},null,512),[[y,s(o).title]])]),e("div",De,[t[17]||(t[17]=e("label",{class:"text-sm font-medium text-slate-300"},"Slug",-1)),w(e("input",{"onUpdate:modelValue":t[6]||(t[6]=l=>s(o).slug=l),required:"",type:"text",placeholder:"url-friendly-slug",class:"w-full bg-slate-950 border border-white/10 rounded-xl px-4 py-2.5 text-white text-sm focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/50 transition-all"},null,512),[[y,s(o).slug]])]),e("div",Ue,[t[18]||(t[18]=e("label",{class:"text-sm font-medium text-slate-300"},"Cover Image URL",-1)),w(e("input",{"onUpdate:modelValue":t[7]||(t[7]=l=>s(o).coverImage=l),type:"url",placeholder:"https://...",class:"w-full bg-slate-950 border border-white/10 rounded-xl px-4 py-2.5 text-white text-sm focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/50 transition-all"},null,512),[[y,s(o).coverImage]])]),e("div",Me,[t[19]||(t[19]=e("label",{class:"text-sm font-medium text-slate-300"},"Excerpt",-1)),w(e("textarea",{"onUpdate:modelValue":t[8]||(t[8]=l=>s(o).excerpt=l),rows:"2",placeholder:"A brief summary of the post...",class:"w-full bg-slate-950 border border-white/10 rounded-xl px-4 py-2.5 text-white text-sm focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/50 transition-all resize-none"},null,512),[[y,s(o).excerpt]])]),e("div",Ve,[t[20]||(t[20]=e("label",{class:"text-sm font-medium text-slate-300"},"Content (Markdown)",-1)),w(e("textarea",{"onUpdate:modelValue":t[9]||(t[9]=l=>s(o).content=l),required:"",rows:"10",placeholder:"Write your post content in Markdown...",class:"w-full bg-slate-950 border border-white/10 rounded-xl px-4 py-2.5 text-white text-sm font-mono focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/50 transition-all resize-none"},null,512),[[y,s(o).content]]),t[21]||(t[21]=e("p",{class:"text-xs text-slate-500"},"Supports Markdown: **bold**, *italic*, # headers, etc.",-1))]),e("div",Ee,[t[22]||(t[22]=e("div",null,[e("p",{class:"text-sm font-medium text-white"},"Publish Now"),e("p",{class:"text-xs text-slate-500"},"Make this post visible on the public website")],-1)),e("button",{type:"button",onClick:t[10]||(t[10]=l=>s(o).published=!s(o).published),class:C(["w-12 h-7 rounded-full relative transition-colors",s(o).published?"bg-indigo-600":"bg-slate-700"])},[e("div",{class:C(["absolute top-1 w-5 h-5 bg-white rounded-full transition-all duration-300",s(o).published?"right-1":"left-1"])},null,2)],2)]),e("div",Ie,[e("button",{type:"button",onClick:t[11]||(t[11]=l=>c.value=!1),class:"flex-1 px-4 py-2.5 rounded-xl bg-white/5 hover:bg-white/10 text-white text-sm font-medium border border-white/5 transition-colors"}," Cancel "),e("button",{type:"submit",disabled:s(_),class:"flex-1 px-4 py-2.5 rounded-xl bg-indigo-600 hover:bg-indigo-500 text-white text-sm font-medium shadow-lg shadow-indigo-500/20 transition-all disabled:opacity-70"},u(s(_)?"Saving...":s(m)?"Save Changes":"Create Post"),9,Se)])],32)])])):z("",!0)])),d(O,{modelValue:s(b),"onUpdate:modelValue":t[12]||(t[12]=l=>A(b)?b.value=l:null),title:"Delete Post",description:`Are you sure you want to delete '${s(g)?.title}'? This action cannot be undone.`,"confirm-text":"Delete",onConfirm:R},null,8,["modelValue","description"]),d(W,{ref_key:"toastRef",ref:D,title:s(p),message:s(f),type:s(v)},null,8,["title","message","type"])])}}};export{Je as default};
